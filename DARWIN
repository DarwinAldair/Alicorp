import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.util.Scanner;
import java.math.BigDecimal;
import java.math.RoundingMode;

public class Alicorp {
    Scanner scanner = new Scanner(System.in);
    String[] Alimentos = {"Tallarín", "Aceites Primor", "Oreo", "Atún", "Cereales Ángel", "harina Integral", "Paneton", "Gelatina", "Sporade", "Leche Gloria"};
    String[] Extras = {"Alimento Para Peces Nutriplan", "AquaHealth", "Premezclas para panadería", "Grasa vegetal"};
    String[] Cuidados = {"Jabon", "Champu", "Desodorante", "Pañales Huggies", "Detergente", "Suavizante downy"};
    double[] precios = {5.50, 10.20, 5, 3.50, 15, 5, 25, 3.50, 8, 4, 3, 6, 3, 5.50, 3.50, 2, 8, 3.50, 3, 2};
    double subtotal = 0;
    double igv;
    double totalpagar;
    StringBuilder productosComprados = new StringBuilder();
    String nombreCliente, apellidoCliente, dniCliente, fechaNacimiento;

    public void iniciarCompra() {
        System.out.println("---------BIENVENIDO A ALICORP-----------");
        System.out.println("Ingrese su nombre:");
        nombreCliente = scanner.nextLine();
        System.out.println("Ingrese su apellido:");
        apellidoCliente = scanner.nextLine();
        System.out.println("Ingrese su DNI:");
        dniCliente = scanner.nextLine();
        System.out.println("Ingrese el día de su nacimiento:");
        scanner.nextLine();
        System.out.println("Ingrese el mes de su nacimiento:");
        scanner.nextLine();
        System.out.println("Ingrese el año de su nacimiento:");
        fechaNacimiento = scanner.nextLine();
        System.out.println("Gracias por ingresar su información.");
        mostrarMenu();
    }

    public void mostrarMenu() {
        int opcion;
        do {
            System.out.println("----------BIENVENIDO A ALICORP----------");
            System.out.println("1. Comprar productos");
            System.out.println("2. precio de productos");
            System.out.println("3. Salir");
            System.out.print("Ingrese su opción: ");
            opcion = scanner.nextInt();
            scanner.nextLine();

            switch (opcion) {
                case 1:
                    comprarProductos();
                    break;
                case 2:
                    mostrarListaProductos();
                    break;
                case 3:
                    System.out.println("Gracias por visitar ALICORP. ¡Hasta pronto!");
                    break;
                default:
                    System.out.println("Opción no válida. Por favor, ingrese una opción válida.");
                    break;
            }
        } while (opcion != 3);
    }

    public void mostrarListaProductos() {
        System.out.println("------LISTA DE PRODUCTOS DISPONIBLES------------");
        System.out.println("ALIMENTOS:");
        for (int i = 0; i < Alimentos.length; i++) {
            System.out.println((i + 1) + ". " + Alimentos[i] + " - S/ " + precios[i]);
        }
        System.out.println("EXTRAS:");
        for (int i = 0; i < Extras.length; i++) {
            System.out.println((i + 1 + Alimentos.length) + ". " + Extras[i] + " - S/ " + precios[Alimentos.length + i]);
        }
        System.out.println("CUIDADOS:");
        for (int i = 0; i < Cuidados.length; i++) {
            System.out.println((i + 1 + Alimentos.length + Extras.length) + ". " + Cuidados[i] + " - S/ " + precios[Alimentos.length + Extras.length + i]);
        }
        System.out.println("Presione Enter para volver al menú principal...");
        scanner.nextLine();
    }

    public void comprarProductos() {
        int tipoProducto;
        int indiceProducto;
        int cantidad;

        do {
            System.out.println("------ESTOS SON ALGUNOS DE LOS PRODUCTOS QUE OFRECEMOS------------");
            System.out.println("ALIMENTOS:");
            for (int i = 0; i < Alimentos.length; i++) {
                System.out.println((i + 1) + ". " + Alimentos[i]);
            }
            System.out.println("EXTRAS:");
            for (int i = 0; i < Extras.length; i++) {
                System.out.println((i + 1 + Alimentos.length) + ". " + Extras[i]);
            }
            System.out.println("CUIDADOS:");
            for (int i = 0; i < Cuidados.length; i++) {
                System.out.println((i + 1 + Alimentos.length + Extras.length) + ". " + Cuidados[i]);
            }

            System.out.print("Seleccione el producto a comprar (1-" + (Alimentos.length + Extras.length + Cuidados.length) + "): ");
            tipoProducto = scanner.nextInt();
            scanner.nextLine();

            if (tipoProducto < 1 || tipoProducto > Alimentos.length + Extras.length + Cuidados.length) {
                System.out.println("Opción no válida. Inténtelo de nuevo.");
                continue;
            }

            System.out.print("Ingrese la cantidad a comprar: ");
            cantidad = scanner.nextInt();
            scanner.nextLine();

            if (tipoProducto <= Alimentos.length) {
                indiceProducto = tipoProducto - 1;
                subtotal += precios[indiceProducto] * cantidad;
                productosComprados.append(Alimentos[indiceProducto]).append(" - ").append(cantidad).append(" unidades - S/ ").append(precios[indiceProducto] * cantidad).append("\n");
            } else if (tipoProducto <= Alimentos.length + Extras.length) {
                indiceProducto = tipoProducto - Alimentos.length - 1;
                subtotal += precios[Alimentos.length + indiceProducto] * cantidad;
                productosComprados.append(Extras[indiceProducto]).append(" - ").append(cantidad).append(" unidades - S/ ").append(precios[Alimentos.length + indiceProducto] * cantidad).append("\n");
            } else {
                indiceProducto = tipoProducto - Alimentos.length - Extras.length - 1;
                subtotal += precios[Alimentos.length + Extras.length + indiceProducto] * cantidad;
                productosComprados.append(Cuidados[indiceProducto]).append(" - ").append(cantidad).append(" unidades - S/ ").append(precios[Alimentos.length + Extras.length + indiceProducto] * cantidad).append("\n");
            }

            System.out.print("¿Desea agregar más productos? (1. Sí / 2. No): ");
            tipoProducto = scanner.nextInt();
            scanner.nextLine();

        } while (tipoProducto != 2);

        calcularTotal();
    }

    public void calcularTotal() {
        igv = subtotal * 0.18;
        // Redondear el IGV a dos decimales
        igv = BigDecimal.valueOf(igv).setScale(2, RoundingMode.HALF_UP).doubleValue();
        totalpagar = subtotal + igv;
        generarBoleta();
    }

    public void generarBoleta() {
        System.out.println("----BOLETA DE VENTA---------");
        System.out.println("Cliente: " + nombreCliente + " " + apellidoCliente);
        System.out.println("DNI: " + dniCliente);
        System.out.println("Fecha de nacimiento: " + fechaNacimiento);
        System.out.println("PRODUCTOS:");
        System.out.println(productosComprados.toString());
        System.out.println("SUBTOTAL: S/ " + subtotal);
        System.out.println("IGV (18%): S/ " + igv);
        System.out.println("TOTAL A PAGAR: S/ " + totalpagar);

        exportarBoleta();
    }

    public void exportarBoleta() {
        try {
            String ruta = System.getProperty("user.home") + "\\Documents\\boleta.txt";
            File archivo = new File(ruta);
            FileWriter escritor = new FileWriter(archivo);
            escritor.write("----BOLETA DE VENTA---------\n");
            escritor.write("Cliente: " + nombreCliente + " " + apellidoCliente + "\n");
            escritor.write("DNI: " + dniCliente + "\n");
            escritor.write("Fecha de nacimiento: " + fechaNacimiento + "\n\n");
            escritor.write("PRODUCTOS:\n");
            escritor.write(productosComprados.toString());
            escritor.write("\nSUBTOTAL: S/ " + subtotal + "\n");
            escritor.write("IGV (18%): S/ " + igv + "\n");
            escritor.write("TOTAL A PAGAR: S/ " + totalpagar + "\n");
            escritor.close();
            System.out.println("Boleta de venta generada exitosamente en " + ruta);
        } catch (IOException e) {
            System.out.println("Error al exportar la boleta: " + e.getMessage());
        }
    }

    public static void main(String[] args) {
        Alicorp tienda = new Alicorp();
        tienda.iniciarCompra();
    }
}
